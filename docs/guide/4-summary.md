# é¡¹ç›®æ€»ç»“

## ä¸€ã€ä¸ªäººçœ‹æ³•

### ORM

è¯´å®è¯ï¼Œå¦‚æœé¡¹ç›®æ˜¯é‡‡ç”¨æ•æ·å¼€å‘çš„æ–¹å¼ï¼Œå¾ˆå¤šæ—¶å€™æ•°æ®åº“æ–¹é¢ä¸ä¼šè®¾è®¡çš„å¾ˆå®Œç¾ã€‚å°¤å…¶æ˜¯å°å…¬å¸ï¼Œæ—¶é—´ç´§ï¼Œä»»åŠ¡é‡ï¼Œå¯¼è‡´ç¨‹åºå‘˜ç›´æ¥æ¢­å“ˆï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ä»¥åå†è¯´ã€‚ç»“æœå°±æ˜¯ï¼šåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­éœ€è¦é¢‘ç¹çš„æ·»åŠ æˆ–è€…ä¿®æ”¹å­—æ®µï¼Œé¡¹ç›®ä¸­å¦‚æœä¸ä½¿ç”¨ lombok é‚£æ˜¯ç›¸å½“éš¾å—çš„ï¼›å¦‚æœé‡‡ç”¨çš„æ‰‹å†™ SQLï¼Œç»´æŠ¤æ‰€ä»˜å‡ºçš„æ—¶é—´å’Œç²¾åŠ›ä¹Ÿæ˜¯å¾ˆå¤§çš„ï¼Œå°¤å…¶æ˜¯åæœŸã€‚å½“ç„¶ï¼Œä½ å¯ä»¥æŠŠ SQL æŒ‰ç…§åŠŸèƒ½æˆ–è€…ä¸šåŠ¡åˆ†ç±»è¿›è¡Œæ–‡ä»¶æ‹†åˆ†ï¼Œä½†æ˜¯ç»´æŠ¤èµ·æ¥è¿˜æ˜¯å¾ˆéº»çƒ¦ã€‚é‚£å°†éå¸¸çš„æµªè´¹~~æ‘¸é±¼çš„~~ ï¼ˆå­¦ä¹ çš„ï¼‰æ—¶é—´ã€‚æ‰€ä»¥é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ ORM æ¡†æ¶æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚

æˆ‘è‡ªå·±å·¥ä½œä¸­ä¸æ˜¯ä½¿ç”¨ MyBatis å°±æ˜¯ MyBatis Plus(MP)ï¼Œå…¶å®ƒçš„åªæ˜¯æœ‰æ‰€äº†è§£ä½†æ²¡æ€ä¹ˆä½¿ç”¨è¿‡ã€‚å”‰ï¼Œæ€ä¹ˆè¯´å‘¢ï¼ŒSQL å†™å¤šäº†ï¼Œæœ‰æ—¶å€™ä¼šæ€€ç–‘äººç”Ÿï¼Œä½¿ç”¨ Java8 è¿˜ä¸èƒ½ç”¨ record å¿«é€Ÿæ„å»ºä¸€ä¸ªå“åº”å¯¹è±¡ï¼Œå¯¼è‡´æœ€ç»ˆå¾ˆå¤šçš„ DTO ç±»ï¼Œä½†æ˜¯é‡Œé¢åªæœ‰å‡ ä¸ªå­—æ®µğŸ¤£

æœ€åï¼Œæˆ‘è‡ªå·±æƒ³è¯•è¯• Spring Data JPAï¼Œè¿™ä¸ªä¸œè¥¿æä¾›äº†ä¸€ç§å« SQL Query DSL çš„ä¸œä¸œï¼Œç›´æ¥ä½¿ç”¨ Java ä»£ç å®Œæˆ SQLï¼ˆæˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢è¿™ç§ï¼Œè§ä»è§æ™ºå§ï¼Œä¸»è¦æ˜¯ SQL ä¼˜åŒ–å¯ä»¥å…¨éƒ¨æ‰”ç»™æ¡†æ¶æä¾›è€…å®ç°ï¼Œå·ä¸ªæ‡’ï¼Œå˜¿å˜¿~ï¼‰ã€‚

é‚£å°±æœ‰äººè¯´äº†ï¼ŒMP ä¹Ÿæœ‰å•Šï¼åºŸè¯ï¼Œæˆ‘çŸ¥é“æœ‰ï¼Œä¹Ÿç”¨è¿‡äº†ï¼Œåªæ˜¯æ— æ³•å®Œæˆä¸€äº›è¿è¡¨æŸ¥è¯¢ï¼Œè€Œä¸”æƒ³è¯•è¯•æ–°ä¸œè¥¿æ²¡æœ‰é—®é¢˜å§ï¼

ç„¶åï¼Œç„¶åï¼Œç„¶åè‡ªå·±ç¨€é‡Œç³Šæ¶‚çš„å‘ç°äº† Jimmerï¼Œçœ‹äº†ä½œè€…å¤§å¤§çš„å®ç°æ€è·¯å’Œç†å¿µï¼Œæœ€ç»ˆå†³å®šæ¢æˆè¿™ä¸ªå°è¯•ä¸€å“ˆ~æ¡†æ¶ä½œè€…å¸®æˆ‘ä¼˜åŒ– SQLï¼Œæ¬¸å˜¿ï¼

> OLAP(On-line Transaction Processing) è”æœºåˆ†æå¤„ç†ï¼ˆBIï¼‰ï¼Œé€‚åˆä½¿ç”¨ MyBatisï¼Œè¿™ç§æŸ¥è¯¢éœ€è¦çµæ´»æ€§ï¼Œé«˜çµæ´»æ€§å¯ä»¥å¯¹å»ºæ¨¡è¦æ±‚æ¾ä¸€äº›ï¼›
> OLTP(On-line Analytical Processing) è”æœºäº‹åŠ¡å¤„ç†ï¼ˆå•†åŸï¼‰ï¼Œé€‚åˆä½¿ç”¨ Jimmerã€Hibernate ç­‰ ORMï¼Œè¯¥ç±»ä¸šåŠ¡è¦ç”¨ä¸¥æ ¼æŠŠæ§å®ä½“å»ºæ¨¡ï¼Œåœ¨å‰æœŸå°±è¦æŠŠå»ºæ¨¡å®Œå–„ã€è®¾è®¡å¥½ï¼›

## äºŒã€å­¦ä¹ ç±»åº“

è¿™äº›ç±»åº“åœ¨é¡¹ç›®ä¸­éƒ½æ²¡æœ‰ç”¨è¿‡ï¼Œä¸ºäº†ç®€æ´ã€å‡å°‘ä¾èµ–ï¼Œè¿™é‡Œå•ç‹¬æ‹å‡ºæ¥å†™ã€‚è¿™äº›ä¸œè¥¿éƒ½æ˜¯å¼€å‘è¿‡ç¨‹ä¸­åœ¨ç½‘ä¸Šè·å–èµ„æ–™æ—¶å‘ç°çš„ï¼Œçœ‹èµ·æ¥æŒºä¸é”™çš„ã€‚å¯ä»¥é…Œæƒ…åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚

- é›†åˆåº“ï¼š[eclipse collections](https://www.eclipse.org/collections/)ï¼Œå…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒçœ‹è¿™ç¯‡æ–‡ç« ï¼šhttps://www.baeldung.com/eclipse-collections

## ä¸‰ã€RBAC

æƒé™ç³»ç»Ÿå¯ä»¥ä¿æŠ¤æŸäº›æ¥å£ä¸è¢«å…¶å®ƒäººæ»¥ç”¨ï¼Œä»è€Œæå‡ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ä½ ä¹Ÿå¯ä»¥ç®€å•ç†è§£ä¸ºä¸“é—¨ä¸ºæŸä¸€éƒ¨åˆ†äººå¼€æ”¾çš„ç‰¹æƒï¼Œéƒ½æ˜¯å¯ä»¥çš„ã€‚ç°åœ¨çš„æƒé™ç®¡ç†åŸºæœ¬éƒ½æ˜¯åŸºäº RBACï¼ˆRole Base Access Controlï¼‰æˆ–è€… RBAC çš„å˜ä½“ï¼Œä½†å…¶æœ¬è´¨ç›¸å·®ä¸å¤§ï¼Œè½åˆ°å®åœ°çš„è¯å°±æ˜¯è¡¨ä¹‹é—´çš„å…³è”å…³ç³»è¾ƒå¤šè¾ƒæ‚ã€‚

äºŒå…«å®šå¾‹é˜æ˜äº†é«˜çº§ç”¨æˆ·ä¸å…¶ä»–ç”¨æˆ·çš„æ•°é‡ï¼Œé‚£ä¹ˆåŸºäºæ­¤å°±æœ‰äº† RBACã€‚

é«˜çº§æƒé™ã€ç‰¹åˆ«æƒé™ã€å®šåˆ¶æƒé™åªæ˜¯å°‘éƒ¨åˆ†äººæ‰èƒ½æ‹¥æœ‰çš„ã€‚ä½†æ˜¯åƒæµªå­ä¸€æ ·çš„æ™®é€šç”¨æˆ·æœ‰å¾ˆå¤šï¼ŒåŸºæ•°è¾ƒå¤§ï¼Œæ‹¥æœ‰çš„æƒé™å¹¶æ— å¤ªå¤§çš„å˜åŒ–ã€‚å½“æ–°ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œæ¯æ¬¡æ‰‹åŠ¨ç»™ç”¨æˆ·æˆæƒï¼Œå¼€æ”¾ä¸€ä¸ªä¸€ä¸ªçš„æƒé™åˆ™ä¼šæµªè´¹å¾ˆå¤šçš„æ—¶é—´ï¼ˆä¸€ä¸ªä¸€ä¸ªæ˜¯å› ä¸ºæŸäº›ç³»ç»Ÿçš„æƒé™ç³»ç»Ÿç²’åº¦è¾ƒå°ï¼‰ã€‚å½“ç„¶è¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥æ¯æ¬¡æˆæƒçš„æ—¶å€™é€‰æ‹©é»˜è®¤å€¼ï¼Œç„¶åæ ¹æ®ä¸åŒçš„ç”¨æˆ·å†è¿›è¡Œä¸åŒæƒé™çš„é€‰æ‹©ï¼Œè¿™æ ·ä»ç„¶è¾ƒä¸ºéº»çƒ¦ã€‚

RBAC æ¨¡å‹å°±æä¾›äº†ä¸€ç§è¾ƒå¥½çš„å®ç°ï¼šå…ˆæŠŠå¯¹åº”çš„æƒé™ï¼ˆæ¯”å¦‚è®¿é—®è·¯å¾„ã€æ“ä½œèœå•ç­‰ï¼‰èµ‹ç»™ä¸€ä¸ªè§’è‰²ï¼Œç”¨æˆ·éœ€è¦ä»€ä¹ˆæƒé™ï¼Œå°±å…³è”ä¸€ä¸ªè§’è‰²ã€‚å¦‚æœç”¨æˆ·éœ€è¦æ›´æ”¹æƒé™ï¼Œç›´æ¥ä¿®æ”¹ç”¨æˆ·-è§’è‰²çš„å…³è”å…³ç³»å³å¯è‡ªåŠ¨ç»§æ‰¿è§’è‰²å¯¹åº”çš„æƒé™ã€‚ä¸ä»…èŠ‚çœæ—¶é—´ï¼Œè¿˜åˆ©äºç»´æŠ¤ã€‚

æ‰€ä»¥è¿™æ ·çœ‹èµ·æ¥ï¼ŒRBAC ä¹Ÿæ˜¯ä¸€ç§ä»£ç†æ¨¡å¼ï¼Œè§’è‰²å……å½“äº†å¤šä¸ªæƒé™çš„ä»£ç†ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªä»£ç†å¯ä»¥è®¿é—®å¯¹åº”çš„èµ„æºã€‚

å›ºå®šæƒé™ + å®šåˆ¶æƒé™ï¼šä¸€èˆ¬å¯¹äºç³»ç»Ÿæ¥è®²ï¼Œæˆ‘ä»¬éœ€è¦åˆ†éƒ¨é—¨ï¼Œéƒ¨é—¨æ‹¥æœ‰çš„æƒé™éƒ½æ˜¯å›ºå®šçš„ï¼Œç„¶åå¯¹äºé‡Œé¢çš„æˆå‘˜å¤„äºä¸åŒçš„å²—ä½å°†ä¼šæ‹¥æœ‰ä¸ä¸€æ ·çš„æƒé™ã€‚è¿™æ ·å°±å¤šå‡ºäº†ä¸¤ä¸ªåˆ†æ”¯ï¼šéƒ¨é—¨ã€å²—ä½ã€‚
æˆ‘ä»¬å¯ä»¥æŠŠéƒ¨é—¨è§†ä½œç”¨æˆ·ç»„ï¼Œè€Œå²—ä½å°±æ˜¯æŠŠç”¨æˆ·ç»„çš„ç”¨æˆ·å†ç»†åˆ†ä¸€æ¬¡ã€‚è¿™å°±æ˜¯ RBAC æ¨¡å‹çš„å˜ç§ä¹‹ä¸€ã€‚

ä¸¾ä¾‹å­è¯´åºŸè¯ï¼š

ä½“è‚²éƒ¨æœ‰ä¸¤ä¸ªäººï¼šé¢¨é€é¥å’Œæé€é¥ï¼Œé¢¨é€é¥æ˜¯ä½“è‚²éƒ¨éƒ¨é•¿ï¼Œæé€é¥æ˜¯ä½“è‚²éƒ¨æˆå‘˜ã€‚åŠ å…¥ä½“è‚²éƒ¨ä¾¿æ‹¥æœ‰è¯¥éƒ¨é—¨çš„åŸºæœ¬æƒé™ï¼Œç›¸å¯¹æ¥è¯´ï¼Œéƒ¨é•¿æ‹¥æœ‰ä¸€äº›æˆå‘˜æ²¡æœ‰çš„æƒé™ï¼Œä¾‹å¦‚å¯ä»¥å¯¹ä½“è‚²éƒ¨æ¶æ„å’Œäººå‘˜è¿›è¡Œä¿®æ”¹ã€è°ƒåŠ¨ã€‚

å¹¿æ’­éƒ¨ä¹Ÿæœ‰ä¸¤ä¸ªäººï¼šç´ è¿˜çœŸå’Œå²è‰³æ–‡ï¼Œç´ è¿˜çœŸæ˜¯å¹¿æ’­éƒ¨éƒ¨é•¿ï¼Œå²è‰³æ–‡æ˜¯å¹¿æ’­éƒ¨æˆå‘˜ã€‚å¹¿æ’­çš„å†…å®¹æ˜¯éœ€è¦éƒ¨é•¿æ‹æ¿å®šç –çš„ï¼Œå²è‰³æ–‡å¹¿æ’­çš„å†…å®¹éƒ¨é•¿é€‰å®šçš„ç¨¿å­ã€‚

ä»¥ä¸Šåªæ˜¯å­¦æ ¡ä¸­çš„ä¸¤ä¸ªç®€å•éƒ¨é—¨ï¼Œå¯èƒ½è¿˜æœ‰å¾ˆå¤šå…¶å®ƒçš„éƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨éƒ½æœ‰éƒ¨é•¿ã€æˆå‘˜ç”šè‡³æ˜¯å…¶å®ƒçš„å²—ä½ï¼Œé‚£ä¹ˆæœ‰å¿…è¦ä¸ºæ¯ä¸ªéƒ¨é—¨éƒ½è®¾ç½®ä¸€ä¸ªå…·ä½“çš„è§’è‰²ï¼Ÿè¿™æ ·çš„è¯æ˜¾ç„¶è¦é€ å‡ºå¾ˆå¤šçš„è§’è‰²ï¼Œè¿™äº›è§’è‰²åªæ˜¯ç®¡ç†çš„æ¨¡å—ä¸åŒã€‚

æ‰€ä»¥å‘¢

```mermaid
graph LR
user1((user1)) --> éƒ¨é—¨1 --> å²—ä½1 --> è§’è‰²1 --> æƒé™åˆ—è¡¨1

u2((user2)) --> éƒ¨é—¨1 --> å²—ä½2 --> è§’è‰²2 -> æƒé™åˆ—è¡¨2

u3((user3)) --> éƒ¨é—¨2 --> å²—ä½1 --> è§’è‰²3 -> æƒé™åˆ—è¡¨2
```

æ®æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ’å…¥ä¸€ä¸ªå¤§çš„çº§åˆ«ï¼šéƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨åˆ›å»ºçš„æ—¶å€™ç›´æ¥å’Œè¯¥éƒ¨é—¨çš„åŸºç¡€æƒé™ç»‘å®šï¼ŒåŠ å…¥éƒ¨é—¨çš„æˆå‘˜è‡ªåŠ¨ç»§æ‰¿è¿™äº›æƒé™ã€‚å¯¹äºè¯¥éƒ¨é—¨çš„é¢†å¯¼ä¹‹ç±»çš„æ–°å»ºä¸åŒçš„è§’è‰²å³å¯ã€‚

## é™„å½•ï¼šæœ‰å¸®åŠ©çš„ä¸€äº›æ–‡æ¡£/ç½‘ç«™

### JWT

- https://jwt.io/introduction/

### Java å¼‚æ­¥

- https://www.callicoder.com/java-8-completablefuture-tutorial/
- https://www.callicoder.com/java-concurrency-multithreading-basics/
- https://www.codedemo.club/spring-security-async-principal-propagation/
